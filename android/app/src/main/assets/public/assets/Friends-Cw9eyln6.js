import{r as t,j as e,g as r}from"./index-Cny3-YC3.js";import{L as v,A as N,a as b,b as w}from"./Layout-63m88gTv.js";import{B as n}from"./button-vWn4QgZQ.js";function q(){const[l,f]=t.useState([]),[m,u]=t.useState([]),[h,j]=t.useState([]),i=async()=>{try{const s={Authorization:`Bearer ${r()}`},[a,c,o]=await Promise.all([fetch("/api/friends/requests",{headers:s}).catch(()=>null),fetch("/api/friends/suggestions",{headers:s}).catch(()=>null),fetch("/api/friends/list",{headers:s}).catch(()=>null)]);a&&a.ok&&f((await a.json()).requests||[]),c&&c.ok&&u((await c.json()).users||[]),o&&o.ok&&j((await o.json()).friends||[])}catch{}};t.useEffect(()=>{i()},[]);const g=async s=>{await fetch(`/api/users/${s}/accept`,{method:"POST",headers:{Authorization:`Bearer ${r()}`}}),i()},x=async s=>{await fetch(`/api/friends/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${r()}`}}),i()},p=async s=>{await fetch(`/api/users/${s}/follow`,{method:"POST",headers:{Authorization:`Bearer ${r()}`}}),i()},d=({u:s,actions:a})=>e.jsxs("div",{className:"flex items-center justify-between gap-3 p-2 rounded-lg hover:bg-muted/60",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(N,{className:"h-10 w-10",children:[e.jsx(b,{src:s.avatar_url||"https://i.pravatar.cc/100?img=12",alt:s.name}),e.jsx(w,{children:s.name[0]})]}),e.jsx("div",{className:"font-medium",children:s.name})]}),e.jsx("div",{className:"flex items-center gap-2",children:a})]});return e.jsx(v,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("section",{className:"rounded-xl border bg-card p-3",children:[e.jsx("h2",{className:"font-semibold mb-2",children:"Friend requests"}),e.jsxs("div",{className:"divide-y",children:[l.map(s=>e.jsx(d,{u:s,actions:e.jsxs(e.Fragment,{children:[e.jsx(n,{size:"sm",onClick:()=>g(s.id),children:"Confirm"}),e.jsx(n,{size:"sm",variant:"outline",onClick:()=>x(s.id),children:"Remove"})]})},s.id)),!l.length&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"No requests"})]})]}),e.jsxs("section",{className:"rounded-xl border bg-card p-3",children:[e.jsx("h2",{className:"font-semibold mb-2",children:"Suggestions"}),e.jsxs("div",{className:"divide-y",children:[m.map(s=>e.jsx(d,{u:s,actions:e.jsx(n,{size:"sm",onClick:()=>p(s.id),children:"Add friend"})},s.id)),!m.length&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"No suggestions"})]})]}),e.jsxs("section",{className:"rounded-xl border bg-card p-3",children:[e.jsx("h2",{className:"font-semibold mb-2",children:"Friends"}),e.jsxs("div",{className:"divide-y",children:[h.map(s=>e.jsx(d,{u:s,actions:e.jsx(n,{size:"sm",variant:"outline",onClick:()=>x(s.id),children:"Unfriend"})},s.id)),!h.length&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"No friends yet"})]})]})]})})}export{q as default};
