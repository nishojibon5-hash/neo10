import{r as n,k as j,j as e,L as x,g as v}from"./index-Cny3-YC3.js";import{L as h,A as N,a as b,b as w}from"./Layout-63m88gTv.js";import{P as k}from"./PostCard-CWJJR5AN.js";import{B as d}from"./button-vWn4QgZQ.js";function P(){const[s,c]=n.useState(null),[p,f]=n.useState([]),t=j();return n.useEffect(()=>{(async()=>{const l=v();if(!l){t("/login");return}const m=await fetch("/api/auth/me",{headers:{Authorization:`Bearer ${l}`}});if(!m.ok){t("/login");return}const o=await m.json();c(o.user);const i=await(await fetch(`/api/users/${o.user.id}`)).json();c(i.user);const u=await fetch(`/api/users/${o.user.id}/posts`);if(u.ok){const g=((await u.json()).posts||[]).map(a=>({id:a.id,author:{id:a.user_id,name:i.user.name,avatar:i.user.avatar_url||"https://i.pravatar.cc/100?img=12"},content:a.content||"",mode:a.content_mode==="html"?"html":"text",image:a.image_url||void 0,video:a.video_url||void 0,createdAt:new Date(a.created_at).toLocaleString(),likes:0,comments:0,shares:0,monetized:!!a.monetized}));f(g)}})()},[t]),s?e.jsxs(h,{children:[e.jsxs("div",{className:"rounded-xl border overflow-hidden",children:[e.jsx("div",{className:"h-56 w-full bg-cover bg-center",style:{backgroundImage:`url(${s.cover_url||"https://images.unsplash.com/photo-1503264116251-35a269479413?q=80&w=1600&auto=format&fit=crop"})`}}),e.jsxs("div",{className:"p-4 flex items-center gap-4",children:[e.jsxs(N,{className:"h-24 w-24 -mt-16 border-4 border-card rounded-full",children:[e.jsx(b,{src:s.avatar_url||"https://i.pravatar.cc/100?img=68",alt:s.name}),e.jsx(w,{children:s.name?.[0]||"U"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl font-bold leading-tight",children:s.name}),s.username?e.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",s.username]}):null]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:"secondary",children:"Add to story"}),e.jsx(x,{to:"/messages",children:e.jsx(d,{variant:"outline",children:"Message"})}),e.jsx(x,{to:"/profile/edit",children:e.jsx(d,{children:"Edit profile"})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[360px_minmax(0,1fr)] gap-4 mt-4",children:[e.jsx("aside",{className:"space-y-4",children:e.jsxs("div",{className:"rounded-xl border bg-card p-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Intro"}),s.bio?e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:s.bio}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Add a short bio from Edit profile."})]})}),e.jsx("section",{className:"space-y-4",children:p.map(r=>e.jsx(k,{post:r},r.id))})]})]}):e.jsx(h,{children:e.jsx("div",{className:"mx-auto max-w-2xl p-6 text-center text-sm text-muted-foreground",children:"Loading..."})})}export{P as default};
