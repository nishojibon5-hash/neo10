import{r as c,j as e,f as l,x as y,y as N,z as m,L as u}from"./index-Cny3-YC3.js";import{L as v}from"./Layout-63m88gTv.js";import{B as x,I as w}from"./button-vWn4QgZQ.js";import{u as p}from"./useQuery-BbV0FT1p.js";const f=c.forwardRef(({className:a,...r},t)=>e.jsx("div",{ref:t,className:l("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r}));f.displayName="Card";const C=c.forwardRef(({className:a,...r},t)=>e.jsx("div",{ref:t,className:l("flex flex-col space-y-1.5 p-6",a),...r}));C.displayName="CardHeader";const b=c.forwardRef(({className:a,...r},t)=>e.jsx("h3",{ref:t,className:l("text-2xl font-semibold leading-none tracking-tight",a),...r}));b.displayName="CardTitle";const k=c.forwardRef(({className:a,...r},t)=>e.jsx("p",{ref:t,className:l("text-sm text-muted-foreground",a),...r}));k.displayName="CardDescription";const g=c.forwardRef(({className:a,...r},t)=>e.jsx("div",{ref:t,className:l("p-6 pt-0",a),...r}));g.displayName="CardContent";const q=c.forwardRef(({className:a,...r},t)=>e.jsx("div",{ref:t,className:l("flex items-center p-6 pt-0",a),...r}));q.displayName="CardFooter";function L({item:a}){return e.jsx(u,{to:`/marketplace/item/${a.id}`,className:"block",children:e.jsx(f,{className:"hover:shadow-md transition",children:e.jsxs(g,{className:"p-0",children:[e.jsx("img",{src:a.image_url||"/placeholder.svg",alt:a.title,className:"w-full h-44 object-cover rounded-t-md"}),e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"font-semibold line-clamp-1",children:a.title}),a.price!=null&&e.jsxs("div",{className:"text-primary font-bold",children:["à§³ ",Number(a.price).toLocaleString()]}),a.location&&e.jsx("div",{className:"text-xs text-muted-foreground",children:a.location})]})]})})})}function $(){const[a,r]=y(),t=N(),d=a.get("q")||"",i=a.get("category")||"",{data:h}=p({queryKey:["market-categories"],queryFn:async()=>(await(await fetch("/api/market/categories")).json()).categories}),{data:j}=p({queryKey:["market-listings",d,i],queryFn:async()=>{const s=new URLSearchParams;return d&&s.set("q",d),i&&s.set("category",i),await(await fetch(`/api/market/listings${s.toString()?`?${s.toString()}`:""}`)).json()}});return e.jsx(v,{children:e.jsxs("div",{className:"mx-auto max-w-5xl",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Marketplace"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{variant:"outline",onClick:async()=>{(await fetch("/api/market/seed-demo",{method:"POST"})).ok?(m.success("Demo listings added"),t.invalidateQueries({queryKey:["market-listings"]})):m.error("Failed to seed")},children:"Load demo"}),e.jsx(u,{to:"/marketplace/create",children:e.jsx(x,{children:"Sell"})})]})]}),e.jsx("div",{className:"flex items-center gap-2 mb-4",children:e.jsx(w,{placeholder:"Search items",value:d,onChange:s=>{const o=s.target.value,n=new URLSearchParams(a);o?n.set("q",o):n.delete("q"),r(n,{replace:!0})},className:"max-w-sm"})}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 mb-4",children:(h||[]).map(s=>e.jsx("button",{onClick:()=>{const o=new URLSearchParams(a);i===s?o.delete("category"):o.set("category",s),r(o,{replace:!0})},className:`px-3 py-1 rounded-full border ${i===s?"bg-primary text-primary-foreground":"bg-card"}`,children:s},s))}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:(j?.listings||[]).map(s=>e.jsx(L,{item:s},s.id))})]})})}export{$ as default};
